
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>飞机订票系统</title>
    <link href="~/Content/images/log.png" type="image/x-icon" rel="shortcut icon" />
    <link href="~/Content/layui/css/layui.css" rel="stylesheet" />
    <!--bootstrap 框架样式表-->
    <link href="~/Content/bootstrap-4.1.3-dist/css/bootstrap.min.css" rel="stylesheet" />
    <!--后台模板中的字体图标css样式-->
    <link href="~/Content/app-assets/fonts/feather/style.min.css" rel="stylesheet" />
    <link href="~/Content/app-assets/fonts/simple-line-icons/style.min.css" rel="stylesheet" />
    <!--系统维护样式表-->
    <link href="~/Content/css/SystemMaintenance.css" rel="stylesheet" />
    <style>
        .content {
            margin-left: 5%;
            margin-right: 5%;
        }
        div{
            font-family: "华文彩云";
        }
        h4{
            font-family: "华文彩云";
        }
        h5{
            font-family: "华文彩云";
        }
        p{
            font-family: "华文彩云";
        }
         label{
            font-family: "华文彩云";
        }
        input{
            font-family: "华文彩云";
        }
        tr{
            font-family: "华文彩云";
        }
        td{
            font-family: "华文彩云";
        }
        th{
            font-family: "华文彩云";
        }
        b{
            font-family: "华文彩云";
        }
        button{
            font-family: "华文彩云";
        }
        a{
            font-family: "华文彩云";
        }
        h2{
            font-family: "华文彩云";
        }
        dd{
            font-family: "华文彩云";
        }
        span{
            font-family: "华文彩云";
        }
        select{
            font-family: "华文彩云";
        }
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <h4 class="text-center py-3">导 出 旅 客 数 据</h4>
        <div class="content py-3 text-center">
            @*条件查询的表单*@
            <form id="frmSearch">
                <div class="form-row">
                    <label for="UserID" class="col-form-label text-right col-1">选择时间段</label>
                    <input type="text" class="form-control  col-2" id="startEndDate" />
                    <button type="button" class="layui-btn ml-2" onclick="searchPassenger()">预览</button>
                    <button type="button" class="layui-btn ml-2" onclick="exportExcel()">导出Excel</button>
                </div>
            </form>
            @*table*@
            <table id="tabPassenger" lay-filter="tabTicket"></table>
        </div>
    </div>

    <script src="~/Content/js/jquery-3.2.1.min.js"></script>
    <script src="~/Content/bootstrap-4.1.3-dist/js/bootstrap.min.js"></script>
    <script src="~/Content/layui/layui.js"></script>
    <script src="~/Content/js/customfunction.js"></script>

    <script>
        var layer, layuiTable, laydate;
        var tabPassenger;

        $(function () {
            //加载layer
            layui.use(['layer', 'table', 'laydate'], function () {
                layer = layui.layer;
                layuiTable = layui.table;
                laydate = layui.laydate;
                //日期控件初始化
                laydate.render({
                    elem: '#startEndDate',
                    type: "date",
                    range: true,
                    trigger: 'click'//解决Laydate绑定input元素一闪而过的问题
                });

                //表格的初始化
                tabPassenger = layuiTable.render({
                    elem: "#tabPassenger", //table的ID HTML元素的ID
                    //url: "SelectTicketById",//数据接口 方法的路径 --由于需要进行条件查询，url这里不用指定
                    data: [],//多条件查询，先初始化空数据
                    cols: [
                        [
                            { title: '序号', type: 'numbers' }, //序号列，title设定标题名称
                            { title: '旅客姓名', field: 'passengerName', align: 'center' },
                            { title: '旅客类别', field: 'passengerType', align: 'center' },
                            { title: '证件类型', field: 'certificatesType', align: 'center' },
                            { title: '证件号', field: 'certificatesCode', align: 'center' },
                            { title: '联系人姓名', field: 'contactName', align: 'center' },
                            { title: '联系人电话', field: 'contactPhone', align: 'center' }
                        ]
                    ],
                    page: {
                        limit: 10, //指定每页显示的条数
                        limits: [5, 10, 15, 20, 25, 30, 35, 40, 45, 50], //每页条数的选择项
                    }, //开启分页
                });

                searchPassenger();
            });

        });
        //预览按钮点击事件
        function searchPassenger() {
            var startEndDate = $("#startEndDate").val();
            tabPassenger.reload({
                url: '@Url.Content("~/OthersMaintenance/ExportLKdata/SelectPassengerData")',
                where: {
                    startEndDate: startEndDate
                }
            });
        }
        //导出Excel按钮点击事件
        function exportExcel() {
            var startEndDate = $("#startEndDate").val();
            //在新页面打开下载的url
            window.open('@Url.Content("~/OthersMaintenance/ExportLKdata/ExportLKDATA?startEndDate=")' + startEndDate);
        }

    </script>
</body>
</html>
